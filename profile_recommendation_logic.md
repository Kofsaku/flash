# プロフィールおすすめ機能 - ベストロジック設計

## 概要
ユーザーのプロフィール情報、学習履歴、パフォーマンスデータを組み合わせて、最適な学習コンテンツを推奨するロジックシステム。

## 1. 優先度付けシステム

### 優先度レベル定義
- **CRITICAL (100点)**: 緊急対応が必要
- **HIGH (80点)**: 高優先度での対応推奨  
- **MEDIUM (60点)**: 標準的な推奨
- **LOW (40点)**: 補助的な推奨

## 2. コアロジック

### A. 学習パフォーマンス分析

#### 苦手分野特定ロジック
```
IF 正解率 < 50% AND 学習回数 >= 3回 THEN
  優先度 = CRITICAL
  推奨タイプ = "集中復習"
  
ELSE IF 正解率 < 70% AND 学習回数 >= 2回 THEN
  優先度 = HIGH  
  推奨タイプ = "段階的復習"
  
ELSE IF 完了率 < 30% AND 開始から7日経過 THEN
  優先度 = MEDIUM
  推奨タイプ = "継続学習"
```

#### 学習スランプ検出
```
IF 過去7日間の正解率 < 過去30日間の平均正解率 - 15% THEN
  優先度 = HIGH
  推奨タイプ = "モチベーション回復"
  推奨内容 = お気に入りコンテンツ or 簡単なレベル
```

### B. プロフィール適合性マッチング

#### 学習目標ベース推奨
```
学習目標が "ビジネス英語" の場合:
  IF 興味トピック contains "ビジネス" THEN
    推奨コンテンツ += ビジネス系カテゴリー (優先度 +20点)
  
  IF 英語使用場面 contains "職場" THEN  
    推奨コンテンツ += 職場シチュエーション (優先度 +15点)
    
  IF 業界が指定されている THEN
    推奨コンテンツ += 業界特化コンテンツ (優先度 +25点)
```

#### ライフスタイル適応
```
IF ライフスタイル contains "忙しい" THEN
  推奨学習時間 = 5-10分セッション
  推奨タイプ = "短時間集中"
  
IF ライフスタイル contains "朝型" AND 現在時刻 < 10:00 THEN
  優先度 += 10点
  
IF ライフスタイル contains "夜型" AND 現在時刻 >= 19:00 THEN  
  優先度 += 10点
```

### C. 学習スタイル最適化

#### 学習方法適合性
```
IF 学習スタイル contains "視覚的学習" THEN
  推奨コンテンツ += 図表・画像系コンテンツ (優先度 +15点)
  
IF 学習スタイル contains "聴覚的学習" THEN
  推奨コンテンツ += 音声・リスニング系 (優先度 +15点)
  
IF 学習スタイル contains "反復学習" THEN
  推奨タイプ = "スペースドリピート"
  復習間隔調整 = 短め
  
IF 学習スタイル contains "ゲーム的学習" THEN
  推奨コンテンツ += ゲーミフィケーション要素 (優先度 +20点)
```

#### スキルバランス調整
```
スキルレベル差分 = MAX(スキルレベル) - MIN(スキルレベル)

IF スキルレベル差分 >= 2段階 THEN
  推奨タイプ = "弱点強化"
  推奨コンテンツ = 最低スキルレベル対応コンテンツ
  優先度 = HIGH
```

### D. 時間的コンテキスト

#### 日次目標管理
```
目標達成率 = 本日完了数 / 日次目標

IF 目標達成率 < 0.3 AND 残り時間 < 3時間 THEN
  優先度 = CRITICAL
  推奨タイプ = "目標達成支援"
  推奨コンテンツ = 短時間・高効率コンテンツ
  
IF 目標達成率 >= 1.0 THEN
  推奨タイプ = "ボーナス学習"  
  推奨コンテンツ = 発展的内容 or お気に入り
```

#### 学習継続性
```
連続学習日数 = current_streak

IF 連続学習日数 >= 7 THEN
  推奨タイプ = "習慣維持"
  ボーナス要素 = 達成感・報酬系
  
IF 連続学習日数 == 0 AND 前回学習から24時間経過 THEN
  優先度 = HIGH
  推奨タイプ = "学習復帰"
  推奨コンテンツ = 簡単・短時間コンテンツ
```

## 3. 条件分岐マトリックス

### シチュエーション別推奨ロジック

#### 新規ユーザー（プロフィール完了後）
```
IF プロフィール完成度 >= 80% AND 学習履歴 == 0 THEN
  推奨優先順位:
  1. 英語レベル適合コンテンツ (優先度 = HIGH)
  2. 学習目標関連コンテンツ (優先度 = HIGH)  
  3. 興味トピック関連 (優先度 = MEDIUM)
  4. 学習スタイル適合 (優先度 = MEDIUM)
```

#### アクティブユーザー（継続学習中）
```
IF 学習日数 >= 7 AND 正解率 >= 70% THEN
  推奨優先順位:
  1. 苦手分野強化 (優先度 = HIGH)
  2. 新規カテゴリー挑戦 (優先度 = MEDIUM)
  3. 発展学習 (優先度 = MEDIUM)
  4. 復習・定着 (優先度 = LOW)
```

#### スランプユーザー（成績低下中）  
```
IF 直近7日正解率 < 平均正解率 - 15% THEN
  推奨優先順位:
  1. お気に入り復習 (優先度 = HIGH)
  2. 簡単レベル復帰 (優先度 = HIGH)
  3. モチベーション回復コンテンツ (優先度 = MEDIUM)
  4. 学習方法見直し提案 (優先度 = MEDIUM)
```

#### 復帰ユーザー（学習中断後）
```
IF 最終学習から >= 3日 AND 過去に学習履歴あり THEN
  推奨優先順位:
  1. 過去の復習 (優先度 = HIGH)
  2. 得意分野から再開 (優先度 = HIGH)
  3. 目標再設定提案 (優先度 = MEDIUM)
  4. 習慣再構築支援 (優先度 = MEDIUM)
```

## 4. 高度な個人化要素

### A. 学習効率パターン認識
```
個人学習効率スコア = (正解率 × 0.4) + (継続率 × 0.3) + (完了率 × 0.3)

IF 個人学習効率スコア >= 80 THEN
  推奨ペース = 標準の1.2倍
  推奨難易度 = +1レベル
  
IF 個人学習効率スコア < 60 THEN  
  推奨ペース = 標準の0.8倍
  推奨難易度 = 現レベル維持
```

### B. 興味関心マッチング
```
興味スコア計算:
FOR EACH コンテンツカテゴリー:
  興味スコア = 0
  IF カテゴリー in ユーザー興味トピック THEN 興味スコア += 30
  IF カテゴリー in ユーザー趣味関連 THEN 興味スコア += 20  
  IF カテゴリー in ユーザー業界関連 THEN 興味スコア += 25
  IF カテゴリー in ユーザー使用場面 THEN 興味スコア += 15
  
推奨優先度 += 興味スコア
```

### C. 学習環境適応
```
現在の学習環境推定:
IF 学習時間帯 in 通勤時間帯 AND ユーザー学習環境 contains "通勤中" THEN
  推奨コンテンツタイプ = 音声中心
  推奨セッション時間 = 短時間
  
IF 現在時刻 in 自宅時間帯 AND ユーザー学習環境 contains "自宅" THEN
  推奨コンテンツタイプ = フル機能
  推奨セッション時間 = 標準〜長時間
```

## 5. 実装優先順位

### Phase 1: 基本ロジック実装
1. プロフィール適合性マッチング
2. 学習パフォーマンス分析
3. 日次目標管理

### Phase 2: 高度な個人化
1. 学習効率パターン認識  
2. 興味関心マッチング
3. 時間的コンテキスト対応

### Phase 3: 最適化・改善
1. 機械学習ベース推奨
2. A/Bテスト実装
3. フィードバックループ構築

## 6. 成功指標（KPI）

- **ユーザーエンゲージメント**: 推奨コンテンツクリック率 >= 60%
- **学習継続性**: 推奨による学習継続率 >= 70%  
- **学習効果**: 推奨コンテンツでの正解率 >= 平均+5%
- **ユーザー満足度**: 推奨満足度評価 >= 4.0/5.0

## 7. 注意事項・制約

- プライバシー保護: 個人情報の適切な処理
- パフォーマンス: 推奨計算時間 < 200ms
- フォールバック: プロフィール不完全時のデフォルト推奨
- 多様性確保: 同一カテゴリー偏重の防止（最大50%まで）

---

*このロジックは継続的に改善・最適化されるべきものです。ユーザーフィードバックと学習データ分析に基づいて定期的な見直しを実施してください。*